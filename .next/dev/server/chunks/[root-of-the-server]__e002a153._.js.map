{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/hernan%20system/gym/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@/lib/generated/prisma\";\n\n// Ensure a single PrismaClient instance in dev and prod\nconst globalForPrisma = globalThis as unknown as {\n  prisma?: PrismaClient;\n};\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log:\n      process.env.NODE_ENV === \"development\"\n        ? [\"query\", \"error\", \"warn\"]\n        : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.prisma = prisma;\n}\n\n"],"names":[],"mappings":";;;;;;;;;;AAEA,wDAAwD;AACxD,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,aAAa;IACf,KACE,uCACI;QAAC;QAAS;QAAS;KAAO,GAC1B;AACR;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///C:/hernan%20system/gym/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth, { type NextAuthOptions } from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\nimport { compare } from \"bcryptjs\";\nimport { prisma } from \"@/lib/db\";\n\nexport const authOptions: NextAuthOptions = {\n  session: {\n    strategy: \"jwt\",\n  },\n  pages: {\n    signIn: \"/auth/sign-in\",\n  },\n  providers: [\n    Credentials({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"email\" },\n        password: { label: \"Password\", type: \"password\" },\n      },\n      async authorize(credentials) {\n        if (!credentials?.email || !credentials?.password) {\n          return null;\n        }\n\n        const user = await prisma.user.findUnique({\n          where: { email: credentials.email },\n        });\n\n        if (!user || user.status !== \"ACTIVE\") {\n          return null;\n        }\n\n        const isValid = await compare(credentials.password, user.password);\n        if (!isValid) {\n          return null;\n        }\n\n        return {\n          id: user.id,\n          name: user.name,\n          email: user.email,\n          role: user.role,\n        } as any;\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        // first login\n        token.id = (user as any).id;\n        token.role = (user as any).role;\n      }\n\n      // ensure role is present on subsequent calls\n      if (!token.role && token.email) {\n        const dbUser = await prisma.user.findUnique({\n          where: { email: token.email as string },\n          select: { id: true, role: true },\n        });\n        if (dbUser) {\n          token.id = dbUser.id;\n          token.role = dbUser.role;\n        }\n      }\n\n      return token;\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        (session.user as any).id = token.id;\n        (session.user as any).role = token.role;\n      }\n      return session;\n    },\n  },\n};\n\nconst handler = NextAuth(authOptions);\n\nexport { handler as GET, handler as POST };\n\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAEO,MAAM,cAA+B;IAC1C,SAAS;QACP,UAAU;IACZ;IACA,OAAO;QACL,QAAQ;IACV;IACA,WAAW;QACT,IAAA,qKAAW,EAAC;YACV,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,OAAO;gBACT;gBAEA,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE,OAAO,YAAY,KAAK;oBAAC;gBACpC;gBAEA,IAAI,CAAC,QAAQ,KAAK,MAAM,KAAK,UAAU;oBACrC,OAAO;gBACT;gBAEA,MAAM,UAAU,MAAM,IAAA,8IAAO,EAAC,YAAY,QAAQ,EAAE,KAAK,QAAQ;gBACjE,IAAI,CAAC,SAAS;oBACZ,OAAO;gBACT;gBAEA,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,MAAM,KAAK,IAAI;oBACf,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,cAAc;gBACd,MAAM,EAAE,GAAG,AAAC,KAAa,EAAE;gBAC3B,MAAM,IAAI,GAAG,AAAC,KAAa,IAAI;YACjC;YAEA,6CAA6C;YAC7C,IAAI,CAAC,MAAM,IAAI,IAAI,MAAM,KAAK,EAAE;gBAC9B,MAAM,SAAS,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBAC1C,OAAO;wBAAE,OAAO,MAAM,KAAK;oBAAW;oBACtC,QAAQ;wBAAE,IAAI;wBAAM,MAAM;oBAAK;gBACjC;gBACA,IAAI,QAAQ;oBACV,MAAM,EAAE,GAAG,OAAO,EAAE;oBACpB,MAAM,IAAI,GAAG,OAAO,IAAI;gBAC1B;YACF;YAEA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBACf,QAAQ,IAAI,CAAS,EAAE,GAAG,MAAM,EAAE;gBAClC,QAAQ,IAAI,CAAS,IAAI,GAAG,MAAM,IAAI;YACzC;YACA,OAAO;QACT;IACF;AACF;AAEA,MAAM,UAAU,IAAA,kJAAQ,EAAC"}}]
}